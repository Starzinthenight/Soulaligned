<html>
  <body style="font-family: Arial; max-width: 600px; margin: 40px auto;">
    <h2>Discover Your Soul Blueprint</h2>
    <form id="blueprintForm">
      <label>Name:</label><br/>
      <input type="text" id="name" required><br/><br/>
      <label>Email:</label><br/>
      <input type="email" id="email" required><br/><br/>
      <label>Date of Birth:</label><br/>
      <input type="date" id="dob" required><br/><br/>
      <label>Time of Birth:</label><br/>
      <input type="time" id="tob" required><br/><br/>
      <label>Place of Birth:</label><br/>
      <input type="text" id="pob" required><br/><br/>
      <button type="submit">Generate Blueprint</button>
    </form>
    <pre id="result" style="margin-top: 20px; background: #f4f4f4; padding: 15px;"></pre>
    <script>
      async function getCoords(place) {
        const res = await fetch(`https://nominatim.openstreetmap.org/search?city=${place}&format=json`);
        const data = await res.json();
        return data[0] ? { lat: parseFloat(data[0].lat), lon: parseFloat(data[0].lon) } : null;
      }

      document.getElementById("blueprintForm").onsubmit = async (e) => {
        e.preventDefault();
        const place = document.getElementById("pob").value;
        const coords = await getCoords(place);
        if (!coords) return alert("Location not found");

        const payload = {
          name: document.getElementById("name").value,
          email: document.getElementById("email").value,
          date_of_birth: document.getElementById("dob").value,
          time_of_birth: document.getElementById("tob").value,
          place_of_birth: place,
          latitude: coords.lat,
          longitude: coords.lon
        };

        const res = await fetch("https://soulaligned.onrender.com/soul-blueprint", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
        const result = await res.json();
        document.getElementById("result").innerText = JSON.stringify(result, null, 2);
      };
    </script>
  </body>
</html>